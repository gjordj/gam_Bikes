"0","#############################"
"0","# GENERALIZED ADDITIVE MODEL##################################################################################"
"0","#############################"
"0",""
"0",""
"0",""
"0","#######"
"0","# GAMs##############################################################################################################"
"0","#######"
"0",""
"0","##########################################"
"0","# USING POLYNOMIAL DEGREES OF POLYNOMIALS#"
"0","##########################################"
"0",""
"0","glm1 <- glm(registered~poly(temp, 3)+poly(season, 2)+poly(mnth, 3)+"
"0","              poly(holiday,1) + poly(weekday, 2)+poly(workingday, 1)+poly(weathersit, 2)+"
"0","              poly(atemp, 3)+poly(hum, 3)+poly(windspeed, 2), data=raw_data)"
"0",""
"0","# cv.glm(raw_data, glm1, K=10)$delta[1]"
"0","set.seed(17)"
"0","# k-fold cross validation is a procedure used to estimate the skill of the model on new data."
"0","# https://machinelearningmastery.com/k-fold-cross-validation/"
"0","glm1error <- sqrt(cv.glm(raw_data, glm1, K=10)$delta[1])"
"0","glm1error"
"1","[1]"
"1"," 997.1891"
"1","
"
"0","summary(glm1)"
"1","
Call:
"
"1",""
"1","glm(formula = registered ~ poly(temp, 3) + poly(season, 2) + 
    poly(mnth, 3) + poly(holiday, 1) + poly(weekday, 2) + poly(workingday, 
    1) + poly(weathersit, 2) + poly(atemp, 3) + poly(hum, 3) + 
    poly(windspeed, 2), data = raw_data)"
"1",""
"1","

"
"1","Deviance Residuals: 
"
"1","     Min  "
"1","      1Q  "
"1","  Median  "
"1","      3Q  "
"1","     Max  "
"1","
"
"1","-2790.41  "
"1"," -761.51  "
"1","  -68.39  "
"1","  863.25  "
"1"," 2210.57  "
"1","
"
"1","
Coefficients:
"
"1","                    "
"1","  Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","
(Intercept)         "
"1","   3656.17"
"1","      36.27"
"1"," 100.802"
"1","  < 2e-16"
"1","
poly(temp, 3)1      "
"1","  26810.68"
"1","    8981.90"
"1","   2.985"
"1"," 0.002934"
"1","
poly(temp, 3)2      "
"1"," -27159.51"
"1","    5951.81"
"1","  -4.563"
"1"," 5.94e-06"
"1","
poly(temp, 3)3      "
"1","   2424.52"
"1","    3845.76"
"1","   0.630"
"1"," 0.528611"
"1","
poly(season, 2)1    "
"1","  13300.28"
"1","    2114.06"
"1","   6.291"
"1"," 5.51e-10"
"1","
poly(season, 2)2    "
"1","   -812.48"
"1","    1953.93"
"1","  -0.416"
"1"," 0.677669"
"1","
poly(mnth, 3)1      "
"1","  -4306.53"
"1","    2105.49"
"1","  -2.045"
"1"," 0.041187"
"1","
poly(mnth, 3)2      "
"1","   6533.42"
"1","    2481.38"
"1","   2.633"
"1"," 0.008649"
"1","
poly(mnth, 3)3      "
"1","    739.54"
"1","    1271.01"
"1","   0.582"
"1"," 0.560851"
"1","
poly(holiday, 1)    "
"1","  -2216.86"
"1","    1222.13"
"1","  -1.814"
"1"," 0.070111"
"1","
poly(weekday, 2)1   "
"1","   2117.28"
"1","     995.75"
"1","   2.126"
"1"," 0.033822"
"1","
poly(weekday, 2)2   "
"1","  -4223.71"
"1","    2461.47"
"1","  -1.716"
"1"," 0.086613"
"1","
poly(workingday, 1) "
"1","   7220.36"
"1","    2545.33"
"1","   2.837"
"1"," 0.004688"
"1","
poly(weathersit, 2)1"
"1","  -2803.99"
"1","    1402.72"
"1","  -1.999"
"1"," 0.045993"
"1","
poly(weathersit, 2)2"
"1","  -3753.40"
"1","    1073.58"
"1","  -3.496"
"1"," 0.000501"
"1","
poly(atemp, 3)1     "
"1","  -4688.59"
"1","    8652.39"
"1","  -0.542"
"1"," 0.588069"
"1","
poly(atemp, 3)2     "
"1","  15086.26"
"1","    5877.67"
"1","   2.567"
"1"," 0.010471"
"1","
poly(atemp, 3)3     "
"1","  -8399.11"
"1","    3837.51"
"1","  -2.189"
"1"," 0.028945"
"1","
poly(hum, 3)1       "
"1"," -11572.54"
"1","    1439.35"
"1","  -8.040"
"1"," 3.77e-15"
"1","
poly(hum, 3)2       "
"1","  -5358.14"
"1","    1173.94"
"1","  -4.564"
"1"," 5.91e-06"
"1","
poly(hum, 3)3       "
"1","    881.16"
"1","    1021.80"
"1","   0.862"
"1"," 0.388778"
"1","
poly(windspeed, 2)1 "
"1","  -7411.48"
"1","    1224.64"
"1","  -6.052"
"1"," 2.32e-09"
"1","
poly(windspeed, 2)2 "
"1","   -679.04"
"1","    1012.09"
"1","  -0.671"
"1"," 0.502486"
"1","
"
"1","                    "
"1","    "
"1","
(Intercept)         "
"1"," ***"
"1","
poly(temp, 3)1      "
"1"," ** "
"1","
poly(temp, 3)2      "
"1"," ***"
"1","
poly(temp, 3)3      "
"1","    "
"1","
poly(season, 2)1    "
"1"," ***"
"1","
poly(season, 2)2    "
"1","    "
"1","
poly(mnth, 3)1      "
"1"," *  "
"1","
poly(mnth, 3)2      "
"1"," ** "
"1","
poly(mnth, 3)3      "
"1","    "
"1","
poly(holiday, 1)    "
"1"," .  "
"1","
poly(weekday, 2)1   "
"1"," *  "
"1","
poly(weekday, 2)2   "
"1"," .  "
"1","
poly(workingday, 1) "
"1"," ** "
"1","
poly(weathersit, 2)1"
"1"," *  "
"1","
poly(weathersit, 2)2"
"1"," ***"
"1","
poly(atemp, 3)1     "
"1","    "
"1","
poly(atemp, 3)2     "
"1"," *  "
"1","
poly(atemp, 3)3     "
"1"," *  "
"1","
poly(hum, 3)1       "
"1"," ***"
"1","
poly(hum, 3)2       "
"1"," ***"
"1","
poly(hum, 3)3       "
"1","    "
"1","
poly(windspeed, 2)1 "
"1"," ***"
"1","
poly(windspeed, 2)2 "
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","
"
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","gaussian"
"1",""
"1"," family taken to be "
"1",""
"1","961676"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 1777111972  on 730  degrees of freedom
"
"1",""
"1","Residual deviance:  680866611  on 708  degrees of freedom
"
"1","AIC: "
"1",""
"1","12170"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","2"
"1",""
"1","
"
"1","
"
"0","ggplot(raw_data, aes(x= registered)) + "
"0","  geom_histogram(aes(y=..density..), colour=""black"", fill=""white"")+"
"0","  geom_density(alpha=.2, fill=""#FF6666"")+"
"0","  geom_vline(xintercept = mean(raw_data$registered)+glm1error, linetype=""dotted"", "
"0","             color = ""red"", size=1.5)+"
"0","  geom_vline(xintercept = mean(raw_data$registered)-glm1error, linetype=""dotted"", "
"0","             color = ""red"", size=1.5)+"
"0","  ggtitle(paste(""Polynomial model: Bikes rented interval: +-"", round(glm1error)))"
