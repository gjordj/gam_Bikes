"0","#############################"
"0","# GENERALIZED ADDITIVE MODEL##################################################################################"
"0","#############################"
"0",""
"0",""
"0",""
"0","#######"
"0","# GAMs##############################################################################################################"
"0","#######"
"0",""
"0","##########################################"
"0","# USING POLYNOMIAL DEGREES OF POLYNOMIALS#"
"0","##########################################"
"0",""
"0","glm1 <- glm(casual~poly(temp, 5)+poly(season, 2)+poly(mnth, 4)+"
"0","              poly(holiday,1) + poly(weekday, 5)+poly(workingday, 1)+poly(weathersit, 2)+"
"0","              poly(atemp, 4)+poly(hum, 2)+poly(windspeed, 2), data=raw_data)"
"0",""
"0","# cv.glm(raw_data, glm1, K=10)$delta[1]"
"0","set.seed(17)"
"0","# k-fold cross validation is a procedure used to estimate the skill of the model on new data."
"0","# https://machinelearningmastery.com/k-fold-cross-validation/"
"0","glm1error <- sqrt(cv.glm(raw_data, glm1, K=10)$delta[1])"
"0","glm1error"
"1","[1]"
"1"," 382.4938"
"1","
"
"0","summary(glm1)"
"1","
Call:
"
"1",""
"1","glm(formula = casual ~ poly(temp, 5) + poly(season, 2) + poly(mnth, 
    4) + poly(holiday, 1) + poly(weekday, 5) + poly(workingday, 
    1) + poly(weathersit, 2) + poly(atemp, 4) + poly(hum, 2) + 
    poly(windspeed, 2), data = raw_data)"
"1",""
"1","

"
"1","Deviance Residuals: 
"
"1","     Min  "
"1","      1Q  "
"1","  Median  "
"1","      3Q  "
"1","     Max  "
"1","
"
"1","-1143.44  "
"1"," -226.38  "
"1","  -40.17  "
"1","  164.41  "
"1"," 1600.30  "
"1","
"
"1","
Coefficients:
"
"1","                    "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)         "
"1","   848.18"
"1","      13.37"
"1","  63.452"
"1","  < 2e-16"
"1"," ***"
"1","
poly(temp, 5)1      "
"1","  8798.89"
"1","    3411.67"
"1","   2.579"
"1"," 0.010109"
"1"," *  "
"1","
poly(temp, 5)2      "
"1"," -8514.79"
"1","    2734.02"
"1","  -3.114"
"1"," 0.001918"
"1"," ** "
"1","
poly(temp, 5)3      "
"1"," -1833.04"
"1","    1489.76"
"1","  -1.230"
"1"," 0.218951"
"1","    "
"1","
poly(temp, 5)4      "
"1","  1654.65"
"1","    1128.85"
"1","   1.466"
"1"," 0.143155"
"1","    "
"1","
poly(temp, 5)5      "
"1","   322.27"
"1","     384.51"
"1","   0.838"
"1"," 0.402244"
"1","    "
"1","
poly(season, 2)1    "
"1","  1741.19"
"1","     800.47"
"1","   2.175"
"1"," 0.029946"
"1"," *  "
"1","
poly(season, 2)2    "
"1"," -1629.86"
"1","     803.45"
"1","  -2.029"
"1"," 0.042877"
"1"," *  "
"1","
poly(mnth, 4)1      "
"1"," -1266.21"
"1","     793.03"
"1","  -1.597"
"1"," 0.110790"
"1","    "
"1","
poly(mnth, 4)2      "
"1","   367.07"
"1","    1111.36"
"1","   0.330"
"1"," 0.741277"
"1","    "
"1","
poly(mnth, 4)3      "
"1","   755.65"
"1","     475.68"
"1","   1.589"
"1"," 0.112612"
"1","    "
"1","
poly(mnth, 4)4      "
"1","  -993.42"
"1","     561.47"
"1","  -1.769"
"1"," 0.077276"
"1"," .  "
"1","
poly(holiday, 1)    "
"1","  1213.57"
"1","    2455.09"
"1","   0.494"
"1"," 0.621242"
"1","    "
"1","
poly(weekday, 5)1   "
"1","  1436.54"
"1","     367.46"
"1","   3.909"
"1"," 0.000101"
"1"," ***"
"1","
poly(weekday, 5)2   "
"1","  6752.94"
"1","    6060.00"
"1","   1.114"
"1"," 0.265512"
"1","    "
"1","
poly(weekday, 5)3   "
"1","   -48.12"
"1","     368.00"
"1","  -0.131"
"1"," 0.895995"
"1","    "
"1","
poly(weekday, 5)4   "
"1","  1615.15"
"1","    2699.42"
"1","   0.598"
"1"," 0.549813"
"1","    "
"1","
poly(weekday, 5)5   "
"1","  -440.69"
"1","     366.56"
"1","  -1.202"
"1"," 0.229678"
"1","    "
"1","
poly(workingday, 1) "
"1"," -3598.38"
"1","    6807.70"
"1","  -0.529"
"1"," 0.597267"
"1","    "
"1","
poly(weathersit, 2)1"
"1","  -829.14"
"1","     517.45"
"1","  -1.602"
"1"," 0.109526"
"1","    "
"1","
poly(weathersit, 2)2"
"1","  -277.22"
"1","     392.58"
"1","  -0.706"
"1"," 0.480336"
"1","    "
"1","
poly(atemp, 4)1     "
"1","   409.12"
"1","    3292.23"
"1","   0.124"
"1"," 0.901140"
"1","    "
"1","
poly(atemp, 4)2     "
"1","  4681.76"
"1","    2678.54"
"1","   1.748"
"1"," 0.080923"
"1"," .  "
"1","
poly(atemp, 4)3     "
"1"," -1144.01"
"1","    1481.53"
"1","  -0.772"
"1"," 0.440266"
"1","    "
"1","
poly(atemp, 4)4     "
"1"," -2341.46"
"1","    1224.58"
"1","  -1.912"
"1"," 0.056276"
"1"," .  "
"1","
poly(hum, 2)1       "
"1"," -3582.02"
"1","     533.64"
"1","  -6.712"
"1"," 3.95e-11"
"1"," ***"
"1","
poly(hum, 2)2       "
"1"," -1232.66"
"1","     436.41"
"1","  -2.825"
"1"," 0.004869"
"1"," ** "
"1","
poly(windspeed, 2)1 "
"1"," -2937.29"
"1","     458.49"
"1","  -6.406"
"1"," 2.73e-10"
"1"," ***"
"1","
poly(windspeed, 2)2 "
"1","  -448.73"
"1","     376.45"
"1","  -1.192"
"1"," 0.233652"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","gaussian"
"1",""
"1"," family taken to be "
"1",""
"1","130615.2"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 344158822  on 730  degrees of freedom
"
"1",""
"1","Residual deviance:  91691867  on 702  degrees of freedom
"
"1","AIC: "
"1",""
"1","10716"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","2"
"1",""
"1","
"
"1","
"
"0","ggplot(raw_data, aes(x= casual)) + "
"0","  geom_histogram(aes(y=..density..), colour=""black"", fill=""white"")+"
"0","  geom_density(alpha=.2, fill=""#FF6666"")+"
"0","  geom_vline(xintercept = mean(raw_data$casual)+glm1error, linetype=""dotted"", "
"0","             color = ""red"", size=1.5)+"
"0","  geom_vline(xintercept = mean(raw_data$casual)-glm1error, linetype=""dotted"", "
"0","             color = ""red"", size=1.5)+"
"0","  ggtitle(paste(""Polynomial model: Bikes rented interval: +-"", round(glm1error)))"
