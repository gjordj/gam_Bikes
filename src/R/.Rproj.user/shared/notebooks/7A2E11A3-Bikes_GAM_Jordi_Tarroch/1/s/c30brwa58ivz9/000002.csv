"0","#########################"
"0","#FIT A SMOOTHING SPLINE#################################################################################"
"0","#########################"
"0",""
"0","##################################"
"0","# Degres of freedom of the spline#"
"0","##################################"
"0","#We can also fit a smoothing spline with none other than smooth.spline(). Here we fit a spline with"
"0","# 16 degrees of freedom, then spline chosen by cross-validation, which yields 6.8 degrees of freedom."
"0",""
"0",""
"0","spline_line <- function(raw_data, column, name_variable){"
"0","  raw_data <- raw_data[,c(column, 16)]"
"0","  names(raw_data)[1] <- ""variable"""
"0","  names(raw_data)[2] <- ""cnt"""
"0",""
"0","  fit <- smooth.spline(raw_data$variable, raw_data$cnt, df = 16)"
"0","  fit2 <- smooth.spline(raw_data$variable, raw_data$cnt, cv = TRUE)"
"0","  freedom_degrees <- (fit2$df)"
"0","  "
"0","  # legend('topright', legend = c('16 DF', '9.1 DF'),"
"0","  #        col = c('red','blue'), lty = 1, lwd = 2, cex = 0.8)"
"0","  "
"0","  ggplot() +"
"0","    geom_point(data  =  raw_data, aes(x = variable, y = cnt),size = 1, shape = 1) +"
"0","    labs("
"0","      x = name_variable,"
"0","      y = ""Count"""
"0","    ) + "
"0","    ggtitle(paste(""Freedom degrees:"", freedom_degrees)) + "
"0","    geom_line(aes(x = fit$x, y = fit$y), colour = 'red') + "
"0","    geom_line(aes(x = fit2$x, y = fit2$y), colour = 'blue')"
"0","}"
